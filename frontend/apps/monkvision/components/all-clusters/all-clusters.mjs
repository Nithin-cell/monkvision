import {util} from "/framework/js/util.mjs";
import {monkshu_component} from "/framework/js/monkshu_component.mjs";
const COMPONENT_PATH = util.getModulePath(import.meta);

const pageData = {
    name: "Clusters",
    shift: 0,
    items: [
        {
            data: "0",
            innerTitle: "DISK",
            percentage: "89",
            innerSubtitle: "India",
            color: "red",
            warningColour: "red"
        },
        {
            data: "1",
            innerTitle: "DISK",
            percentage: "50",
            innerSubtitle: "USA",
            color: "yellow"
        },
        {
            data: "2",
            innerTitle: "DISK",
            percentage: "10",
            innerSubtitle: "India",
            color: "green"
        },
        {
            data: "3",
            innerTitle: "DISK",
            percentage: "30",
            innerSubtitle: "JAPAN",
            color: "yellow",
            warningColour: "yellow"
        },
        {
            data: "4",
            innerTitle: "DISK",
            percentage: "95",
            innerSubtitle: "Australia",
            color: "red",
            warningColour: "red"
        },
        {
            data: "5",
            innerTitle: "RESTARTS",
            percentage: "60",
            innerSubtitle: "Australia",
            color: "blue"
        },
        {
            data: "6",
            innerTitle: "ATTACKS",
            percentage: "47",
            innerSubtitle: "Gorakhpur",
            color: "turquoise",
            warningColour: "turquoise"
        },
        {
            data: "7",
            innerTitle: "ATTACKS",
            percentage: "47",
            innerSubtitle: "Gorakhpur",
            color: "turquoise",
            warningColour: "turquoise"
        },
    ]
}
async function elementRendered(element) {
    populateClusters(element);
}

function populateClusters(element){
    element = element?? all_clusters;
    element.shadowRoot.querySelector('.bg text').innerHTML = pageData.name?? "Clusters"
    if(pageData.items && pageData.items.length){
        const arr = pageData.items;
        const container = element.shadowRoot.querySelector('.flex-container');
        container.innerHTML = '';
        let l=arr.length;
        for(let i=0; i<5 && i<l; i++){
            container.insertAdjacentHTML('beforeend', 
            `
            <div class="flex-child${i==0? ' large-child' : ''}">
            ${i==0?
            `<div class="abs fc-bg"><svg viewBox="1008 315 161 161" fill="none" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M1088.12 337.153L1088.21 334.407L1088.38 334.412L1088.29 337.159C1088.24 337.157 1088.18 337.155 1088.12 337.153ZM1084.49 337.154L1084.39 334.407L1084.22 334.413L1084.32 337.159C1084.37 337.157 1084.43 337.156 1084.49 337.154ZM1080.59 337.403L1080.31 334.672L1080.14 334.69L1080.42 337.42C1080.48 337.414 1080.54 337.409 1080.59 337.403ZM1076.82 337.895L1076.37 335.193L1076.2 335.221L1076.65 337.923C1076.71 337.914 1076.77 337.904 1076.82 337.895ZM1073.16 338.617L1072.53 335.954L1072.36 335.993L1072.99 338.656C1073.05 338.643 1073.1 338.63 1073.16 338.617ZM1069.48 339.595L1068.68 336.981L1068.52 337.031L1069.31 339.645C1069.37 339.628 1069.42 339.612 1069.48 339.595ZM1065.78 340.848L1064.81 338.293L1064.65 338.354L1065.62 340.909C1065.67 340.888 1065.73 340.868 1065.78 340.848ZM1062.27 342.304L1061.13 339.817L1060.98 339.888L1062.11 342.376C1062.16 342.352 1062.22 342.328 1062.27 342.304ZM1058.92 343.957L1057.62 341.545L1057.47 341.626L1058.77 344.038C1058.82 344.011 1058.87 343.984 1058.92 343.957ZM1055.62 345.859L1054.17 343.533L1054.02 343.624L1055.47 345.95C1055.52 345.919 1055.57 345.889 1055.62 345.859ZM1052.37 348.029L1050.77 345.803L1050.63 345.903L1052.24 348.129C1052.28 348.096 1052.33 348.062 1052.37 348.029ZM1049.36 350.345L1047.61 348.227L1047.48 348.336L1049.23 350.454C1049.27 350.418 1049.32 350.381 1049.36 350.345ZM1046.55 352.807L1044.67 350.804L1044.55 350.921L1046.43 352.924C1046.47 352.885 1046.51 352.846 1046.55 352.807ZM1043.86 355.495L1041.85 353.619L1041.73 353.744L1043.74 355.62C1043.78 355.578 1043.82 355.536 1043.86 355.495ZM1041.28 358.427L1039.15 356.691L1039.04 356.824L1041.17 358.56C1041.21 358.516 1041.24 358.471 1041.28 358.427ZM1038.96 361.441L1036.73 359.849L1036.63 359.989L1038.86 361.581C1038.9 361.534 1038.93 361.488 1038.96 361.441ZM1036.88 364.543L1034.55 363.1L1034.46 363.246L1036.79 364.689C1036.82 364.641 1036.85 364.592 1036.88 364.543ZM1034.89 367.988L1032.48 366.701L1032.4 366.853L1034.81 368.139C1034.84 368.089 1034.87 368.038 1034.89 367.988ZM1033.24 371.335L1030.75 370.215L1030.68 370.371L1033.17 371.492C1033.19 371.44 1033.22 371.388 1033.24 371.335ZM1031.73 375.008L1029.17 374.053L1029.11 374.214L1031.67 375.17C1031.69 375.116 1031.71 375.062 1031.73 375.008ZM1030.53 378.549L1027.92 377.759L1027.87 377.924L1030.48 378.713C1030.5 378.658 1030.52 378.603 1030.53 378.549ZM1029.56 382.228L1026.89 381.611L1026.85 381.779L1029.52 382.396C1029.53 382.34 1029.54 382.284 1029.56 382.228ZM1028.81 386.06L1026.1 385.622L1026.08 385.792L1028.78 386.23C1028.79 386.173 1028.8 386.117 1028.81 386.06ZM1028.33 389.831L1025.6 389.57L1025.58 389.741L1028.31 390.002C1028.32 389.945 1028.32 389.888 1028.33 389.831ZM1028.1 393.559L1025.35 393.473L1025.34 393.645L1028.09 393.73C1028.09 393.673 1028.09 393.616 1028.1 393.559ZM1028.1 397.193L1025.35 397.288L1025.35 397.459L1028.1 397.365C1028.1 397.308 1028.1 397.251 1028.1 397.193ZM1028.36 401.26L1025.63 401.538L1025.65 401.709L1028.38 401.431C1028.37 401.374 1028.37 401.317 1028.36 401.26ZM1028.84 404.859L1026.13 405.313L1026.16 405.482L1028.86 405.028C1028.86 404.972 1028.85 404.915 1028.84 404.859ZM1029.56 408.523L1026.9 409.149L1026.93 409.316L1029.6 408.691C1029.59 408.635 1029.57 408.579 1029.56 408.523ZM1030.59 412.367L1027.97 413.165L1028.02 413.329L1030.64 412.532C1030.62 412.477 1030.6 412.422 1030.59 412.367ZM1031.79 415.901L1029.23 416.872L1029.3 417.033L1031.85 416.062C1031.83 416.008 1031.81 415.955 1031.79 415.901ZM1033.32 419.569L1030.83 420.705L1030.9 420.862L1033.39 419.725C1033.37 419.673 1033.34 419.621 1033.32 419.569ZM1034.98 422.914L1032.57 424.209L1032.65 424.36L1035.06 423.066C1035.03 423.015 1035.01 422.965 1034.98 422.914ZM1036.89 426.207L1034.57 427.658L1034.66 427.803L1036.98 426.352C1036.95 426.304 1036.92 426.255 1036.89 426.207ZM1039.07 429.446L1036.85 431.051L1036.95 431.191L1039.17 429.585C1039.14 429.538 1039.1 429.492 1039.07 429.446ZM1041.4 432.453L1039.28 434.202L1039.39 434.334L1041.51 432.585C1041.47 432.541 1041.43 432.497 1041.4 432.453ZM1043.87 435.254L1041.86 437.136L1041.98 437.261L1043.98 435.379C1043.94 435.337 1043.91 435.296 1043.87 435.254ZM1046.44 437.824L1044.56 439.833L1044.69 439.95L1046.56 437.941C1046.52 437.902 1046.48 437.863 1046.44 437.824ZM1049.5 440.509L1047.77 442.638L1047.9 442.747L1049.64 440.618C1049.59 440.582 1049.55 440.545 1049.5 440.509ZM1052.38 442.716L1050.79 444.952L1050.93 445.052L1052.52 442.816C1052.48 442.783 1052.43 442.75 1052.38 442.716ZM1055.49 444.796L1054.04 447.127L1054.19 447.217L1055.63 444.887C1055.58 444.857 1055.53 444.826 1055.49 444.796ZM1058.93 446.788L1057.64 449.205L1057.79 449.285L1059.08 446.869C1059.03 446.842 1058.98 446.815 1058.93 446.788ZM1062.28 448.439L1061.16 450.934L1061.31 451.004L1062.43 448.51C1062.38 448.486 1062.33 448.462 1062.28 448.439ZM1065.95 449.955L1065 452.516L1065.16 452.576L1066.11 450.015C1066.06 449.995 1066 449.975 1065.95 449.955ZM1069.49 451.147L1068.7 453.765L1068.87 453.814L1069.66 451.197C1069.6 451.18 1069.55 451.164 1069.49 451.147ZM1073.17 452.125L1072.55 454.79L1072.72 454.829L1073.34 452.163C1073.28 452.15 1073.23 452.137 1073.17 452.125ZM1077 452.873L1076.56 455.578L1076.73 455.606L1077.17 452.9C1077.12 452.891 1077.06 452.882 1077 452.873ZM1080.77 453.353L1080.51 456.086L1080.68 456.102L1080.94 453.369C1080.89 453.364 1080.83 453.359 1080.77 453.353ZM1084.5 453.585L1084.42 456.333L1084.59 456.338L1084.67 453.59C1084.62 453.589 1084.56 453.587 1084.5 453.585ZM1088.31 453.58L1088.4 456.326L1088.57 456.321L1088.48 453.573C1088.42 453.576 1088.36 453.578 1088.31 453.58ZM1092.2 453.319L1092.48 456.05L1092.65 456.032L1092.37 453.301C1092.32 453.307 1092.26 453.313 1092.2 453.319ZM1095.97 452.816L1096.42 455.518L1096.59 455.49L1096.14 452.787C1096.08 452.797 1096.03 452.806 1095.97 452.816ZM1099.63 452.083L1100.26 454.746L1100.43 454.707L1099.8 452.043C1099.74 452.056 1099.69 452.07 1099.63 452.083ZM1103.31 451.094L1104.11 453.709L1104.27 453.658L1103.47 451.043C1103.42 451.06 1103.36 451.077 1103.31 451.094ZM1107 449.83L1107.97 452.386L1108.14 452.325L1107.16 449.769C1107.11 449.79 1107.06 449.81 1107 449.83ZM1110.51 448.363L1111.65 450.851L1111.8 450.78L1110.67 448.292C1110.62 448.316 1110.56 448.339 1110.51 448.363ZM1113.86 446.701L1115.15 449.113L1115.3 449.032L1114.01 446.619C1113.96 446.647 1113.91 446.674 1113.86 446.701ZM1117.15 444.789L1118.6 447.115L1118.75 447.024L1117.29 444.698C1117.25 444.728 1117.2 444.759 1117.15 444.789ZM1120.39 442.61L1121.99 444.836L1122.13 444.736L1120.53 442.509C1120.48 442.543 1120.43 442.576 1120.39 442.61ZM1123.39 440.285L1125.14 442.403L1125.28 442.294L1123.53 440.175C1123.48 440.212 1123.44 440.248 1123.39 440.285ZM1126.2 437.815L1128.08 439.818L1128.2 439.7L1126.32 437.697C1126.28 437.736 1126.24 437.775 1126.2 437.815ZM1128.88 435.119L1130.89 436.995L1131.01 436.869L1129 434.993C1128.96 435.035 1128.92 435.077 1128.88 435.119ZM1131.45 432.179L1133.58 433.915L1133.69 433.782L1131.56 432.046C1131.52 432.09 1131.49 432.135 1131.45 432.179ZM1133.76 429.158L1135.99 430.75L1136.09 430.61L1133.86 429.018C1133.82 429.065 1133.79 429.112 1133.76 429.158ZM1135.83 426.05L1138.16 427.494L1138.25 427.348L1135.92 425.904C1135.89 425.952 1135.86 426.001 1135.83 426.05ZM1137.65 422.903L1140.07 424.19L1140.15 424.038L1137.73 422.752C1137.7 422.802 1137.68 422.853 1137.65 422.903ZM1139.45 419.247L1141.95 420.368L1142.02 420.211L1139.52 419.09C1139.5 419.143 1139.47 419.195 1139.45 419.247ZM1140.84 415.892L1143.4 416.847L1143.46 416.686L1140.9 415.731C1140.88 415.784 1140.86 415.838 1140.84 415.892ZM1142.04 412.355L1144.66 413.144L1144.71 412.98L1142.09 412.191C1142.07 412.245 1142.06 412.3 1142.04 412.355ZM1143.03 408.678L1145.69 409.295L1145.73 409.128L1143.07 408.511C1143.05 408.567 1143.04 408.622 1143.03 408.678ZM1143.79 404.849L1146.49 405.287L1146.52 405.117L1143.82 404.679C1143.81 404.736 1143.8 404.792 1143.79 404.849ZM1144.28 401.079L1147.01 401.34L1147.03 401.169L1144.3 400.908C1144.29 400.965 1144.28 401.022 1144.28 401.079ZM1144.52 397.352L1147.27 397.438L1147.27 397.266L1144.53 397.181C1144.53 397.238 1144.52 397.295 1144.52 397.352ZM1144.52 393.374L1147.27 393.28L1147.26 393.108L1144.52 393.203C1144.52 393.26 1144.52 393.317 1144.52 393.374ZM1144.28 389.65L1147.01 389.373L1146.99 389.202L1144.26 389.479C1144.27 389.536 1144.27 389.593 1144.28 389.65ZM1143.76 385.711L1146.46 385.257L1146.43 385.088L1143.73 385.542C1143.74 385.598 1143.75 385.655 1143.76 385.711ZM1143.02 382.049L1145.69 381.423L1145.65 381.256L1142.99 381.881C1143 381.937 1143.01 381.993 1143.02 382.049ZM1142.09 378.537L1144.7 377.739L1144.65 377.575L1142.04 378.372C1142.05 378.427 1142.07 378.482 1142.09 378.537ZM1140.77 374.678L1143.33 373.707L1143.27 373.546L1140.71 374.517C1140.73 374.571 1140.75 374.624 1140.77 374.678ZM1139.38 371.326L1141.86 370.19L1141.79 370.034L1139.31 371.17C1139.33 371.222 1139.35 371.274 1139.38 371.326ZM1137.72 367.976L1140.14 366.682L1140.06 366.531L1137.64 367.825C1137.67 367.875 1137.7 367.926 1137.72 367.976ZM1135.82 364.679L1138.15 363.227L1138.06 363.082L1135.73 364.533C1135.76 364.581 1135.79 364.63 1135.82 364.679ZM1133.65 361.433L1135.88 359.827L1135.78 359.688L1133.55 361.294C1133.59 361.34 1133.62 361.387 1133.65 361.433ZM1131.34 358.419L1133.45 356.67L1133.35 356.538L1131.23 358.287C1131.26 358.331 1131.3 358.375 1131.34 358.419ZM1128.87 355.611L1130.88 353.728L1130.76 353.603L1128.76 355.486C1128.8 355.527 1128.84 355.569 1128.87 355.611ZM1126.06 352.798L1127.94 350.789L1127.81 350.672L1125.94 352.681C1125.98 352.72 1126.02 352.759 1126.06 352.798ZM1123.25 350.339L1124.99 348.21L1124.86 348.101L1123.12 350.23C1123.17 350.266 1123.21 350.303 1123.25 350.339ZM1120.1 347.923L1121.69 345.688L1121.55 345.588L1119.96 347.823C1120.01 347.857 1120.05 347.89 1120.1 347.923ZM1116.99 345.852L1118.44 343.522L1118.29 343.432L1116.85 345.762C1116.89 345.792 1116.94 345.822 1116.99 345.852ZM1113.85 344.032L1115.13 341.616L1114.98 341.535L1113.69 343.951C1113.74 343.978 1113.79 344.005 1113.85 344.032ZM1110.19 342.23L1111.31 339.735L1111.15 339.665L1110.03 342.159C1110.08 342.183 1110.14 342.206 1110.19 342.23ZM1106.83 340.844L1107.79 338.283L1107.63 338.223L1106.67 340.784C1106.73 340.804 1106.78 340.824 1106.83 340.844ZM1103.3 339.642L1104.09 337.024L1103.92 336.975L1103.13 339.592C1103.19 339.608 1103.24 339.625 1103.3 339.642ZM1099.62 338.653L1100.24 335.988L1100.07 335.949L1099.45 338.614C1099.51 338.627 1099.56 338.64 1099.62 338.653ZM1095.79 337.893L1096.23 335.189L1096.06 335.161L1095.62 337.866C1095.68 337.875 1095.73 337.884 1095.79 337.893ZM1092.02 337.402L1092.28 334.67L1092.11 334.653L1091.85 337.386C1091.91 337.391 1091.96 337.397 1092.02 337.402Z" fill="white"/>
            <circle opacity="0.8" cx="1086.5" cy="395.5" r="78" stroke="white" stroke-dasharray="6 6"/>
            </svg></div>`: ''}
            <glowing-arc parent="clusters" ${Object.keys(arr[i]).map(k=>`${k}="${arr[i][k]}"`).join(' ')}></glowing-arc>
            </div>
            `);
        }
        if(l>5){
            element.shadowRoot.querySelector('#next').parentElement.setAttribute('opacity', 1);
        }
    }
}

function scrollFlex(path, flag){
    if(flag < 0){
        if(Math.abs(pageData.shift) + 5 >= pageData.items.length) return;
    }
    else{
        if(pageData.shift>=0) return;
    }
    const $$ = all_clusters.shadowRoot;
    const flexContainer = $$.querySelector('.flex-container');
    if(flag<0){
        pageData.shift = pageData.shift - 1;
        let parent = flexContainer.querySelector('.large-child');
        let nextSib = parent.nextElementSibling;
        while(nextSib){
            try{
                parent.removeChild(parent.querySelector('glowing-arc'));
            } catch(e){

            }
            parent.appendChild(nextSib.querySelector('glowing-arc'));
            parent = nextSib;
            nextSib = nextSib.nextElementSibling;
        }
        let nextArc = pageData.items[Math.abs(pageData.shift)+4];
        try {
            parent.removeChild(parent.querySelector('glowing-arc'));
        } catch (e) {
            
        }
        parent.insertAdjacentHTML('beforeend', `<glowing-arc parent="clusters" ${Object.keys(nextArc).map(k=>`${k}="${nextArc[k]}"`).join(' ')}></glowing-arc>`);
    }
    else{
        pageData.shift = pageData.shift + 1;
        let parent = flexContainer.querySelector('.flex-child:nth-child(5)');
        let prevSib = parent.previousElementSibling;
        while(prevSib){
            try {
                parent.removeChild(parent.querySelector('glowing-arc'));
            } catch (e) {
                
            }
            parent.appendChild(prevSib.querySelector('glowing-arc'));
            parent = prevSib;
            prevSib = parent.previousElementSibling;
        }
        let prevArc = pageData.items[Math.abs(pageData.shift)];
        parent.insertAdjacentHTML('beforeend', `<glowing-arc parent="clusters" ${Object.keys(prevArc).map(k=>`${k}="${prevArc[k]}"`).join(' ')}></glowing-arc>`);
    }
    let prevPossible = Math.abs(pageData.shift) + 5 < pageData.items.length;
    let nextPossible = pageData.shift<0;
    $$.querySelector('#prev').parentElement.setAttribute('opacity', prevPossible? 1 : 0.6);
    $$.querySelector('#next').parentElement.setAttribute('opacity', nextPossible? 1 : 0.6);
}


export const all_clusters = { trueWebComponentMode:true,elementRendered, scrollFlex}
monkshu_component.register("all-clusters", `${COMPONENT_PATH}/all-clusters.html`, all_clusters);